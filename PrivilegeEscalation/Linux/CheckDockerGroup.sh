#!/bin/bash

# Script: Checks for docker group membership
# Author: tdkmp4n4
# Description: This script checks if current user is inside docker group. That could lead to privilege escalation


echo -e "\e[0m\n"


echo -e "\e[1m···········································································································"
echo -e "············································································································"
echo -e "··   ____             _                                                  _               _                ··"
echo -e "··  |  _ \  ___   ___| | _____ _ __    __ _ _ __ ___  _   _ _ __     ___| |__   ___  ___| | _____ _ __    ··"
echo -e "··  | | | |/ _ \ / __| |/ / _ \ '__|  / _\` | '__/ _ \| | | | '_ \   / __| '_ \ / _ \/ __| |/ / _ \ '__|   ··"
echo -e "··  | |_| | (_) | (__|   <  __/ |    | (_| | | | (_) | |_| | |_) | | (__| | | |  __/ (__|   <  __/ |      ··"
echo -e "··  |____/ \___/ \___|_|\_\___|_|     \__, |_|  \___/ \__,_| .__/   \___|_| |_|\___|\___|_|\_\___|_|      ··"
echo -e "··                                    |___/                |_|                                            ··"
echo -e "··                  ____            _      _ _                    _  _         _  _                       ··"
echo -e "··                 | __ ) _   _ _  | |_ __| | | ___ __ ___  _ __ | || |  _ __ | || |                      ··"
echo -e "··                 |  _ \| | | (_) | __/ _\` | |/ / '_ \` _ \| '_ \| || |_| '_ \| || |_                     ··"
echo -e "··                 | |_) | |_| |_  | || (_| |   <| | | | | | |_) |__   _| | | |__   _|                    ··"
echo -e "··                 |____/ \__, (_)  \__\__,_|_|\_\_| |_| |_| .__/   |_| |_| |_|  |_|                      ··"
echo -e "··                        |___/                            |_|                                            ··"
echo -e "············································································································"
echo -e "············································································································"

echo -e "\e[0m\n"

echo -e "\e[1m\e[34m[+] Checking groups membership\e[0m"
if [[ -n `echo $(id) | grep "root"` ]]; then
    echo -e "\e[1m\e[32m\e[5m[+] User IS  member of docker group. Check for privesc: 'docker run -v /:/hostOS -i -t chrisfosterelli/rootplease'"
else
    echo -e "\e[1m\e[31m[-] User is not member of docker group"
fi

echo -e "\e[0m\n"
